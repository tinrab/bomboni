syntax = "proto3";

package bookstore.v1;

import "v1/auth_resources.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.com/tinrab/bomboni/bookstore/v1;bookstore";

// Authentication service for user management.
service AuthService {
  // Register a new user.
  rpc RegisterUser(RegisterUserRequest) returns (RegisterUserResponse) {}

  // Authenticate user and get access token.
  rpc AuthenticateUser(AuthenticateUserRequest)
      returns (AuthenticateUserResponse) {}

  // Get current user info.
  rpc GetCurrentUser(GetCurrentUserRequest) returns (GetCurrentUserResponse) {}
}

// Register user request.
message RegisterUserRequest {
  // User display name.
  string display_name = 1;

  // User email address.
  string email = 2;

  // User password.
  string password = 3;
}

// Register user response.
message RegisterUserResponse {
  // The registered user.
  User user = 1;

  // Access token for the user.
  AccessToken access_token = 2;
}

// Authenticate user request.
message AuthenticateUserRequest {
  // User email address.
  string email = 1;

  // User password.
  string password = 2;
}

// Authenticate user response.
message AuthenticateUserResponse {
  // Access token for the authenticated user.
  AccessToken access_token = 1;

  // User information.
  User user = 2;
}

// Get current user request.
message GetCurrentUserRequest {}

// Get current user response.
message GetCurrentUserResponse {
  // Current user information.
  User user = 1;
}
